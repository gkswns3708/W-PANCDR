Hyperparameters:
nz: 256
d_dim: 100
lr: 0.0001
lr_critic: 0.001
lam: 1
batch_size: [256, 28]
device: cuda
TX_drug_feat_data_test : cuda:0
TX_drug_adj_data_test  : cuda:0
TX_gexpr_data_test     : cuda:0
TY_test                : cuda:0
Epoch:   2%|██▊                                                                                                                                                                                          | 15/1000 [00:31<34:31,  2.10s/it]
Epoch 0 - VAL: AUC: 0.4995, ACC: 0.3608, Precision: 0.1192, Recall: 0.7172, F1: 0.2044
Epoch 0 - TEST: AUC: 0.4898, ACC: 0.1989, Precision: 0.1187, Recall: 0.9097, F1: 0.2100
Epoch 1 - VAL: AUC: 0.5154, ACC: 0.7069, Precision: 0.1306, Recall: 0.2759, F1: 0.1773
Epoch 1 - TEST: AUC: 0.5130, ACC: 0.7166, Precision: 0.1314, Recall: 0.2534, F1: 0.1731
Epoch 2 - VAL: AUC: 0.5466, ACC: 0.6836, Precision: 0.1455, Recall: 0.3621, F1: 0.2076
Epoch 2 - TEST: AUC: 0.5567, ACC: 0.5884, Precision: 0.1414, Recall: 0.4962, F1: 0.2201
Epoch 3 - VAL: AUC: 0.5648, ACC: 0.6769, Precision: 0.1579, Recall: 0.4207, F1: 0.2296
Epoch 3 - TEST: AUC: 0.5663, ACC: 0.6965, Precision: 0.1553, Recall: 0.3589, F1: 0.2168
Epoch 4 - VAL: AUC: 0.5589, ACC: 0.6542, Precision: 0.1487, Recall: 0.4276, F1: 0.2206
Epoch 4 - TEST: AUC: 0.5525, ACC: 0.4703, Precision: 0.1328, Recall: 0.6373, F1: 0.2198
Epoch 5 - VAL: AUC: 0.5879, ACC: 0.5024, Precision: 0.1404, Recall: 0.6534, F1: 0.2312
Epoch 5 - TEST: AUC: 0.5820, ACC: 0.8011, Precision: 0.2042, Recall: 0.2413, F1: 0.2212
Epoch 6 - VAL: AUC: 0.5781, ACC: 0.6263, Precision: 0.1514, Recall: 0.4914, F1: 0.2314
Epoch 6 - TEST: AUC: 0.5824, ACC: 0.5725, Precision: 0.1465, Recall: 0.5493, F1: 0.2313
Epoch 7 - VAL: AUC: 0.5903, ACC: 0.6940, Precision: 0.1646, Recall: 0.4103, F1: 0.2349
Epoch 7 - TEST: AUC: 0.5882, ACC: 0.6823, Precision: 0.1623, Recall: 0.4120, F1: 0.2329
Epoch 8 - VAL: AUC: 0.5922, ACC: 0.8054, Precision: 0.2219, Recall: 0.2793, F1: 0.2473
Epoch 8 - TEST: AUC: 0.5936, ACC: 0.7927, Precision: 0.2057, Recall: 0.2693, F1: 0.2332
Epoch 9 - VAL: AUC: 0.5999, ACC: 0.7481, Precision: 0.1942, Recall: 0.3810, F1: 0.2573
Epoch 9 - TEST: AUC: 0.5941, ACC: 0.7362, Precision: 0.1818, Recall: 0.3581, F1: 0.2412
Epoch 10 - VAL: AUC: 0.5992, ACC: 0.8097, Precision: 0.2303, Recall: 0.2828, F1: 0.2539
Epoch 10 - TEST: AUC: 0.5928, ACC: 0.7925, Precision: 0.2095, Recall: 0.2785, F1: 0.2391
Epoch 11 - VAL: AUC: 0.6142, ACC: 0.7612, Precision: 0.2034, Recall: 0.3724, F1: 0.2631
Epoch 11 - TEST: AUC: 0.5914, ACC: 0.7407, Precision: 0.1842, Recall: 0.3543, F1: 0.2424
Epoch 12 - VAL: AUC: 0.6160, ACC: 0.7238, Precision: 0.1872, Recall: 0.4224, F1: 0.2594
Epoch 12 - TEST: AUC: 0.5970, ACC: 0.6531, Precision: 0.1620, Recall: 0.4704, F1: 0.2410
Epoch 13 - VAL: AUC: 0.5912, ACC: 0.8300, Precision: 0.2431, Recall: 0.2293, F1: 0.2360
Epoch 13 - TEST: AUC: 0.5919, ACC: 0.5669, Precision: 0.1474, Recall: 0.5645, F1: 0.2338
Epoch 14 - VAL: AUC: 0.6156, ACC: 0.7173, Precision: 0.1821, Recall: 0.4207, F1: 0.2542
Epoch 14 - TEST: AUC: 0.5978, ACC: 0.6428, Precision: 0.1614, Recall: 0.4886, F1: 0.2426
Epoch 15 - VAL: AUC: 0.6150, ACC: 0.7483, Precision: 0.1922, Recall: 0.3741, F1: 0.2539
Epoch 15 - TEST: AUC: 0.6050, ACC: 0.6149, Precision: 0.1560, Recall: 0.5190, F1: 0.2399
Epoch 16 - VAL: AUC: 0.6236, ACC: 0.6585, Precision: 0.1680, Recall: 0.5017, F1: 0.2517
Epoch 16 - TEST: AUC: 0.6103, ACC: 0.6895, Precision: 0.1745, Recall: 0.4431, F1: 0.2504
Epoch 17 - VAL: AUC: 0.6122, ACC: 0.7610, Precision: 0.2021, Recall: 0.3690, F1: 0.2611
Epoch 17 - TEST: AUC: 0.6096, ACC: 0.7669, Precision: 0.2016, Recall: 0.3346, F1: 0.2516
Epoch 18 - VAL: AUC: 0.6289, ACC: 0.6279, Precision: 0.1666, Recall: 0.5621, F1: 0.2570
Epoch 18 - TEST: AUC: 0.6090, ACC: 0.6339, Precision: 0.1649, Recall: 0.5235, F1: 0.2508
Epoch 19 - VAL: AUC: 0.6027, ACC: 0.7406, Precision: 0.1858, Recall: 0.3741, F1: 0.2483
Epoch 19 - TEST: AUC: 0.6012, ACC: 0.6651, Precision: 0.1632, Recall: 0.4507, F1: 0.2396
Epoch 20 - VAL: AUC: 0.6177, ACC: 0.7458, Precision: 0.1964, Recall: 0.3948, F1: 0.2623
Epoch 20 - TEST: AUC: 0.5967, ACC: 0.7867, Precision: 0.2112, Recall: 0.3005, F1: 0.2480
Epoch 21 - VAL: AUC: 0.6152, ACC: 0.7955, Precision: 0.2220, Recall: 0.3138, F1: 0.2600
Epoch 21 - TEST: AUC: 0.6014, ACC: 0.7652, Precision: 0.1948, Recall: 0.3209, F1: 0.2425
Epoch 22 - VAL: AUC: 0.6192, ACC: 0.7837, Precision: 0.2159, Recall: 0.3379, F1: 0.2634
Epoch 22 - TEST: AUC: 0.6097, ACC: 0.7055, Precision: 0.1772, Recall: 0.4158, F1: 0.2485
Epoch 23 - VAL: AUC: 0.6161, ACC: 0.7698, Precision: 0.2082, Recall: 0.3603, F1: 0.2639
Epoch 23 - TEST: AUC: 0.5994, ACC: 0.7556, Precision: 0.1937, Recall: 0.3437, F1: 0.2477
Epoch 24 - VAL: AUC: 0.6200, ACC: 0.5934, Precision: 0.1549, Recall: 0.5724, F1: 0.2438
Epoch 24 - TEST: AUC: 0.6057, ACC: 0.6152, Precision: 0.1581, Recall: 0.5288, F1: 0.2435
Epoch 25 - VAL: AUC: 0.6197, ACC: 0.5701, Precision: 0.1544, Recall: 0.6155, F1: 0.2469
Epoch 25 - TEST: AUC: 0.6096, ACC: 0.5473, Precision: 0.1511, Recall: 0.6206, F1: 0.2430
Epoch 26 - VAL: AUC: 0.6302, ACC: 0.6915, Precision: 0.1790, Recall: 0.4724, F1: 0.2596
Epoch 26 - TEST: AUC: 0.6073, ACC: 0.6846, Precision: 0.1707, Recall: 0.4393, F1: 0.2459
Epoch 27 - VAL: AUC: 0.6158, ACC: 0.6058, Precision: 0.1546, Recall: 0.5466, F1: 0.2410
Epoch 27 - TEST: AUC: 0.6054, ACC: 0.4691, Precision: 0.1431, Recall: 0.7086, F1: 0.2381
Epoch 28 - VAL: AUC: 0.6262, ACC: 0.7223, Precision: 0.1851, Recall: 0.4190, F1: 0.2567
Epoch 28 - TEST: AUC: 0.6047, ACC: 0.7651, Precision: 0.1996, Recall: 0.3346, F1: 0.2501
Epoch 29 - VAL: AUC: 0.6165, ACC: 0.7438, Precision: 0.1916, Recall: 0.3845, F1: 0.2557
Epoch 29 - TEST: AUC: 0.6100, ACC: 0.7230, Precision: 0.1831, Recall: 0.3945, F1: 0.2501
Epoch 30 - VAL: AUC: 0.6217, ACC: 0.6897, Precision: 0.1762, Recall: 0.4655, F1: 0.2557
Epoch 30 - TEST: AUC: 0.5968, ACC: 0.7158, Precision: 0.1742, Recall: 0.3816, F1: 0.2392
Epoch 31 - VAL: AUC: 0.6181, ACC: 0.7531, Precision: 0.1947, Recall: 0.3690, F1: 0.2549
Epoch 31 - TEST: AUC: 0.6123, ACC: 0.6061, Precision: 0.1579, Recall: 0.5455, F1: 0.2449
Traceback (most recent call last):
  File "run_W_PANCDR_5Critic_nested.py", line 86, in <module>
    auc_test_df = train_W_PANCDR_nested(n_outer_splits,data,best_params_file)
  File "/mnt/W-PANCDR/src/ModelTraining/W_PANCDR_5Critic.py", line 308, in train_W_PANCDR_nested
    auc_TEST, current_epoch = model.train(current_params, weight_path=f'../checkpoint/GDSC_kfold/model_best_outerfold_{outer_fold}_{i}.pt')
  File "/mnt/W-PANCDR/src/ModelTraining/W_PANCDR_5Critic.py", line 141, in train
    critic_loss.backward()
  File "/usr/local/lib/python3.8/dist-packages/torch/_tensor.py", line 450, in backward
    torch.autograd.backward(
  File "/usr/local/lib/python3.8/dist-packages/torch/autograd/__init__.py", line 197, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
