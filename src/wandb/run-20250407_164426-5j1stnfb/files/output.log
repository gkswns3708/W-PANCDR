Hyperparameters:
nz: 128
d_dim: 100
lr: 0.0001
lr_critic: 0.0001
lam: 0.01
batch_size: [128, 14]
device: cuda
TX_drug_feat_data_test : cuda:0
TX_drug_adj_data_test  : cuda:0
TX_gexpr_data_test     : cuda:0
TY_test                : cuda:0
Epoch:   2%|██▊                                                                                                                                                                                         | 15/1000 [00:48<52:37,  3.21s/it]
Epoch 0 - VAL: AUC: 0.6078, ACC: 0.7104, Precision: 0.1883, Recall: 0.4621, F1: 0.2676
Epoch 0 - TEST: AUC: 0.6204, ACC: 0.8030, Precision: 0.2562, Recall: 0.3589, F1: 0.2990
Epoch 1 - VAL: AUC: 0.6253, ACC: 0.7600, Precision: 0.2140, Recall: 0.4103, F1: 0.2813
Epoch 1 - TEST: AUC: 0.6456, ACC: 0.7548, Precision: 0.2226, Recall: 0.4393, F1: 0.2955
Epoch 2 - VAL: AUC: 0.6410, ACC: 0.7550, Precision: 0.2230, Recall: 0.4586, F1: 0.3001
Epoch 2 - TEST: AUC: 0.6620, ACC: 0.7654, Precision: 0.2399, Recall: 0.4628, F1: 0.3160
Epoch 3 - VAL: AUC: 0.6521, ACC: 0.7132, Precision: 0.2049, Recall: 0.5224, F1: 0.2943
Epoch 3 - TEST: AUC: 0.6762, ACC: 0.7012, Precision: 0.2128, Recall: 0.5751, F1: 0.3107
Epoch 4 - VAL: AUC: 0.6639, ACC: 0.7574, Precision: 0.2294, Recall: 0.4741, F1: 0.3092
Epoch 4 - TEST: AUC: 0.6874, ACC: 0.7158, Precision: 0.2211, Recall: 0.5660, F1: 0.3180
Epoch 5 - VAL: AUC: 0.6790, ACC: 0.6976, Precision: 0.2003, Recall: 0.5483, F1: 0.2934
Epoch 5 - TEST: AUC: 0.6982, ACC: 0.7067, Precision: 0.2198, Recall: 0.5903, F1: 0.3203
Epoch 6 - VAL: AUC: 0.6868, ACC: 0.7017, Precision: 0.2070, Recall: 0.5672, F1: 0.3034
Epoch 6 - TEST: AUC: 0.6959, ACC: 0.7017, Precision: 0.2171, Recall: 0.5941, F1: 0.3180
Epoch 7 - VAL: AUC: 0.6751, ACC: 0.6577, Precision: 0.1844, Recall: 0.5810, F1: 0.2799
Epoch 7 - TEST: AUC: 0.6964, ACC: 0.6383, Precision: 0.1937, Recall: 0.6608, F1: 0.2996
Epoch 8 - VAL: AUC: 0.6825, ACC: 0.6840, Precision: 0.1988, Recall: 0.5810, F1: 0.2963
Epoch 8 - TEST: AUC: 0.7055, ACC: 0.7036, Precision: 0.2217, Recall: 0.6100, F1: 0.3252
Epoch 9 - VAL: AUC: 0.6838, ACC: 0.7189, Precision: 0.2129, Recall: 0.5397, F1: 0.3054
Epoch 9 - TEST: AUC: 0.7063, ACC: 0.7854, Precision: 0.2739, Recall: 0.5046, F1: 0.3550
Epoch 10 - VAL: AUC: 0.7019, ACC: 0.6571, Precision: 0.1966, Recall: 0.6466, F1: 0.3016
Epoch 10 - TEST: AUC: 0.7136, ACC: 0.7804, Precision: 0.2699, Recall: 0.5137, F1: 0.3539
Epoch 11 - VAL: AUC: 0.7103, ACC: 0.7998, Precision: 0.2799, Recall: 0.4759, F1: 0.3525
Epoch 11 - TEST: AUC: 0.7149, ACC: 0.7743, Precision: 0.2642, Recall: 0.5197, F1: 0.3503
Epoch 12 - VAL: AUC: 0.7130, ACC: 0.7890, Precision: 0.2691, Recall: 0.4914, F1: 0.3478
Epoch 12 - TEST: AUC: 0.7200, ACC: 0.7826, Precision: 0.2745, Recall: 0.5220, F1: 0.3598
Epoch 13 - VAL: AUC: 0.7123, ACC: 0.6992, Precision: 0.2160, Recall: 0.6190, F1: 0.3202
Epoch 13 - TEST: AUC: 0.7153, ACC: 0.7579, Precision: 0.2529, Recall: 0.5463, F1: 0.3457
Epoch 14 - VAL: AUC: 0.7042, ACC: 0.7793, Precision: 0.2590, Recall: 0.4983, F1: 0.3408
Epoch 14 - TEST: AUC: 0.7161, ACC: 0.7448, Precision: 0.2426, Recall: 0.5561, F1: 0.3379
Epoch 15 - VAL: AUC: 0.7161, ACC: 0.7598, Precision: 0.2478, Recall: 0.5397, F1: 0.3397
Epoch 15 - TEST: AUC: 0.7211, ACC: 0.7685, Precision: 0.2667, Recall: 0.5584, F1: 0.3610
Epoch 16 - VAL: AUC: 0.7164, ACC: 0.7773, Precision: 0.2658, Recall: 0.5362, F1: 0.3554
Epoch 16 - TEST: AUC: 0.7198, ACC: 0.7501, Precision: 0.2527, Recall: 0.5797, F1: 0.3520
Epoch 17 - VAL: AUC: 0.7251, ACC: 0.7621, Precision: 0.2541, Recall: 0.5569, F1: 0.3490
Epoch 17 - TEST: AUC: 0.7249, ACC: 0.7715, Precision: 0.2690, Recall: 0.5546, F1: 0.3623
Epoch 18 - VAL: AUC: 0.7197, ACC: 0.7714, Precision: 0.2584, Recall: 0.5328, F1: 0.3480
Epoch 18 - TEST: AUC: 0.7290, ACC: 0.7588, Precision: 0.2600, Recall: 0.5744, F1: 0.3580
Epoch 19 - VAL: AUC: 0.7272, ACC: 0.7349, Precision: 0.2364, Recall: 0.5897, F1: 0.3374
Epoch 19 - TEST: AUC: 0.7356, ACC: 0.6766, Precision: 0.2176, Recall: 0.6791, F1: 0.3296
Epoch 20 - VAL: AUC: 0.7320, ACC: 0.7799, Precision: 0.2696, Recall: 0.5397, F1: 0.3596
Epoch 20 - TEST: AUC: 0.7401, ACC: 0.6798, Precision: 0.2203, Recall: 0.6836, F1: 0.3333
Epoch 21 - VAL: AUC: 0.7367, ACC: 0.7171, Precision: 0.2306, Recall: 0.6293, F1: 0.3375
Epoch 21 - TEST: AUC: 0.7418, ACC: 0.8050, Precision: 0.3047, Recall: 0.5190, F1: 0.3839
Epoch 22 - VAL: AUC: 0.7342, ACC: 0.6836, Precision: 0.2134, Recall: 0.6569, F1: 0.3222
Epoch 22 - TEST: AUC: 0.7386, ACC: 0.8009, Precision: 0.2986, Recall: 0.5197, F1: 0.3793
Epoch 23 - VAL: AUC: 0.7387, ACC: 0.7379, Precision: 0.2424, Recall: 0.6069, F1: 0.3465
Epoch 23 - TEST: AUC: 0.7388, ACC: 0.7289, Precision: 0.2406, Recall: 0.6100, F1: 0.3451
Epoch 24 - VAL: AUC: 0.7385, ACC: 0.7315, Precision: 0.2365, Recall: 0.6034, F1: 0.3398
Epoch 24 - TEST: AUC: 0.7433, ACC: 0.7293, Precision: 0.2408, Recall: 0.6093, F1: 0.3452
Epoch 25 - VAL: AUC: 0.7439, ACC: 0.6917, Precision: 0.2210, Recall: 0.6707, F1: 0.3325
Epoch 25 - TEST: AUC: 0.7471, ACC: 0.7505, Precision: 0.2577, Recall: 0.6017, F1: 0.3609
Epoch 26 - VAL: AUC: 0.7443, ACC: 0.7280, Precision: 0.2333, Recall: 0.6017, F1: 0.3362
Epoch 26 - TEST: AUC: 0.7507, ACC: 0.7380, Precision: 0.2498, Recall: 0.6184, F1: 0.3559
Epoch 27 - VAL: AUC: 0.7369, ACC: 0.7323, Precision: 0.2342, Recall: 0.5897, F1: 0.3353
Epoch 27 - TEST: AUC: 0.7439, ACC: 0.7826, Precision: 0.2798, Recall: 0.5448, F1: 0.3697
Epoch 28 - VAL: AUC: 0.7498, ACC: 0.7100, Precision: 0.2288, Recall: 0.6466, F1: 0.3380
Epoch 28 - TEST: AUC: 0.7517, ACC: 0.6890, Precision: 0.2272, Recall: 0.6897, F1: 0.3418
Epoch 29 - VAL: AUC: 0.7510, ACC: 0.7390, Precision: 0.2434, Recall: 0.6069, F1: 0.3475
Epoch 29 - TEST: AUC: 0.7550, ACC: 0.7454, Precision: 0.2527, Recall: 0.6002, F1: 0.3557
Epoch 30 - VAL: AUC: 0.7509, ACC: 0.6723, Precision: 0.2134, Recall: 0.6931, F1: 0.3263
Epoch 30 - TEST: AUC: 0.7524, ACC: 0.7385, Precision: 0.2509, Recall: 0.6214, F1: 0.3575
Traceback (most recent call last):
  File "run_W_PANCDR_5Critic_nested.py", line 86, in <module>
    auc_test_df = train_W_PANCDR_nested(n_outer_splits,data,best_params_file)
  File "/mnt/W-PANCDR/src/ModelTraining/W_PANCDR_5Critic.py", line 307, in train_W_PANCDR_nested
    while True:
  File "/mnt/W-PANCDR/src/ModelTraining/W_PANCDR_5Critic.py", line 179, in train
    Loss.backward()
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/optimizer.py", line 23, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/adam.py", line 234, in step
    adam(params_with_grad,
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/adam.py", line 300, in adam
    func(params,
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/adam.py", line 410, in _single_tensor_adam
    denom = (exp_avg_sq.sqrt() / bias_correction2_sqrt).add_(eps)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/wandb/sdk/lib/service_connection.py", line 94, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/usr/local/lib/python3.8/dist-packages/wandb/sdk/lib/service_connection.py", line 226, in teardown
    self._router.join()
  File "/usr/local/lib/python3.8/dist-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/usr/lib/python3.8/threading.py", line 1011, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.8/threading.py", line 1027, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
