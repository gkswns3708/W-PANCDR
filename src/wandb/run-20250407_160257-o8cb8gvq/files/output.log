Hyperparameters:
nz: 256
d_dim: 128
lr: 0.0001
lr_critic: 0.001
lam: 0.1
batch_size: [256, 28]
device: cuda
TX_drug_feat_data_test : cuda:0
TX_drug_adj_data_test  : cuda:0
TX_gexpr_data_test     : cuda:0
TY_test                : cuda:0
Epoch:   2%|██▊                                                                                                                                                                                         | 15/1000 [00:30<33:31,  2.04s/it]
Epoch 0 - VAL: AUC: 0.4859, ACC: 0.6609, Precision: 0.1161, Recall: 0.2966, F1: 0.1668
Epoch 0 - TEST: AUC: 0.4913, ACC: 0.2349, Precision: 0.1189, Recall: 0.8634, F1: 0.2090
Epoch 1 - VAL: AUC: 0.5397, ACC: 0.4465, Precision: 0.1276, Recall: 0.6569, F1: 0.2137
Epoch 1 - TEST: AUC: 0.5466, ACC: 0.3583, Precision: 0.1298, Recall: 0.7853, F1: 0.2227
Epoch 2 - VAL: AUC: 0.5701, ACC: 0.7004, Precision: 0.1660, Recall: 0.4017, F1: 0.2349
Epoch 2 - TEST: AUC: 0.5884, ACC: 0.6462, Precision: 0.1589, Recall: 0.4712, F1: 0.2377
Epoch 3 - VAL: AUC: 0.6040, ACC: 0.6563, Precision: 0.1696, Recall: 0.5138, F1: 0.2550
Epoch 3 - TEST: AUC: 0.6157, ACC: 0.6413, Precision: 0.1676, Recall: 0.5205, F1: 0.2536
Epoch 4 - VAL: AUC: 0.6002, ACC: 0.6893, Precision: 0.1739, Recall: 0.4569, F1: 0.2519
Epoch 4 - TEST: AUC: 0.6086, ACC: 0.6796, Precision: 0.1714, Recall: 0.4530, F1: 0.2487
Epoch 5 - VAL: AUC: 0.6030, ACC: 0.6550, Precision: 0.1644, Recall: 0.4931, F1: 0.2466
Epoch 5 - TEST: AUC: 0.5992, ACC: 0.6754, Precision: 0.1665, Recall: 0.4423, F1: 0.2419
Epoch 6 - VAL: AUC: 0.6098, ACC: 0.6814, Precision: 0.1732, Recall: 0.4724, F1: 0.2535
Epoch 6 - TEST: AUC: 0.6126, ACC: 0.7035, Precision: 0.1792, Recall: 0.4279, F1: 0.2526
Epoch 7 - VAL: AUC: 0.6225, ACC: 0.8168, Precision: 0.2577, Recall: 0.3190, F1: 0.2851
Epoch 7 - TEST: AUC: 0.6193, ACC: 0.5736, Precision: 0.1585, Recall: 0.6131, F1: 0.2519
Epoch 8 - VAL: AUC: 0.6390, ACC: 0.7537, Precision: 0.2165, Recall: 0.4397, F1: 0.2901
Epoch 8 - TEST: AUC: 0.6467, ACC: 0.7117, Precision: 0.2012, Recall: 0.4924, F1: 0.2857
Epoch 9 - VAL: AUC: 0.6391, ACC: 0.7282, Precision: 0.2006, Recall: 0.4603, F1: 0.2794
Epoch 9 - TEST: AUC: 0.6357, ACC: 0.6862, Precision: 0.1869, Recall: 0.5015, F1: 0.2723
Epoch 10 - VAL: AUC: 0.6309, ACC: 0.6917, Precision: 0.1861, Recall: 0.5017, F1: 0.2715
Epoch 10 - TEST: AUC: 0.6215, ACC: 0.6863, Precision: 0.1830, Recall: 0.4848, F1: 0.2657
Epoch 11 - VAL: AUC: 0.6390, ACC: 0.6482, Precision: 0.1716, Recall: 0.5414, F1: 0.2606
Epoch 11 - TEST: AUC: 0.6336, ACC: 0.7225, Precision: 0.1951, Recall: 0.4385, F1: 0.2701
Epoch 12 - VAL: AUC: 0.6298, ACC: 0.6173, Precision: 0.1638, Recall: 0.5707, F1: 0.2545
Epoch 12 - TEST: AUC: 0.6156, ACC: 0.6989, Precision: 0.1781, Recall: 0.4347, F1: 0.2526
Epoch 13 - VAL: AUC: 0.6238, ACC: 0.6982, Precision: 0.1787, Recall: 0.4552, F1: 0.2567
Epoch 13 - TEST: AUC: 0.6161, ACC: 0.5529, Precision: 0.1526, Recall: 0.6191, F1: 0.2449
Epoch 14 - VAL: AUC: 0.6359, ACC: 0.6759, Precision: 0.1793, Recall: 0.5121, F1: 0.2657
Epoch 14 - TEST: AUC: 0.6314, ACC: 0.6808, Precision: 0.1811, Recall: 0.4901, F1: 0.2645
Epoch 15 - VAL: AUC: 0.6272, ACC: 0.7369, Precision: 0.1990, Recall: 0.4293, F1: 0.2720
Epoch 15 - TEST: AUC: 0.6211, ACC: 0.7139, Precision: 0.1885, Recall: 0.4370, F1: 0.2634
Epoch 16 - VAL: AUC: 0.6394, ACC: 0.7304, Precision: 0.2009, Recall: 0.4552, F1: 0.2788
Epoch 16 - TEST: AUC: 0.6290, ACC: 0.6944, Precision: 0.1844, Recall: 0.4704, F1: 0.2650
Epoch 17 - VAL: AUC: 0.6241, ACC: 0.7558, Precision: 0.2016, Recall: 0.3828, F1: 0.2641
Epoch 17 - TEST: AUC: 0.6306, ACC: 0.6185, Precision: 0.1662, Recall: 0.5622, F1: 0.2565
Epoch 18 - VAL: AUC: 0.6284, ACC: 0.6925, Precision: 0.1783, Recall: 0.4672, F1: 0.2581
Epoch 18 - TEST: AUC: 0.6295, ACC: 0.5974, Precision: 0.1636, Recall: 0.5933, F1: 0.2565
Epoch 19 - VAL: AUC: 0.6387, ACC: 0.7813, Precision: 0.2238, Recall: 0.3690, F1: 0.2786
Epoch 19 - TEST: AUC: 0.6331, ACC: 0.6821, Precision: 0.1802, Recall: 0.4833, F1: 0.2625
Epoch 20 - VAL: AUC: 0.6402, ACC: 0.6469, Precision: 0.1724, Recall: 0.5483, F1: 0.2623
Epoch 20 - TEST: AUC: 0.6292, ACC: 0.6492, Precision: 0.1724, Recall: 0.5250, F1: 0.2595
Epoch 21 - VAL: AUC: 0.6452, ACC: 0.5699, Precision: 0.1599, Recall: 0.6483, F1: 0.2566
Epoch 21 - TEST: AUC: 0.6345, ACC: 0.8103, Precision: 0.2515, Recall: 0.3141, F1: 0.2794
Epoch 22 - VAL: AUC: 0.6405, ACC: 0.7011, Precision: 0.1866, Recall: 0.4793, F1: 0.2686
Epoch 22 - TEST: AUC: 0.6259, ACC: 0.5546, Precision: 0.1546, Recall: 0.6275, F1: 0.2481
Epoch 23 - VAL: AUC: 0.6427, ACC: 0.6354, Precision: 0.1723, Recall: 0.5741, F1: 0.2650
Epoch 23 - TEST: AUC: 0.6396, ACC: 0.6644, Precision: 0.1827, Recall: 0.5372, F1: 0.2726
Epoch 24 - VAL: AUC: 0.6433, ACC: 0.8143, Precision: 0.2603, Recall: 0.3379, F1: 0.2941
Epoch 24 - TEST: AUC: 0.6312, ACC: 0.8064, Precision: 0.2466, Recall: 0.3179, F1: 0.2778
Epoch 25 - VAL: AUC: 0.6426, ACC: 0.7063, Precision: 0.1873, Recall: 0.4690, F1: 0.2677
Epoch 25 - TEST: AUC: 0.6366, ACC: 0.5360, Precision: 0.1571, Recall: 0.6791, F1: 0.2552
Epoch 26 - VAL: AUC: 0.6634, ACC: 0.7604, Precision: 0.2332, Recall: 0.4776, F1: 0.3133
Epoch 26 - TEST: AUC: 0.6678, ACC: 0.7532, Precision: 0.2320, Recall: 0.4795, F1: 0.3127
Epoch 27 - VAL: AUC: 0.6669, ACC: 0.7544, Precision: 0.2265, Recall: 0.4741, F1: 0.3066
Epoch 27 - TEST: AUC: 0.6704, ACC: 0.7715, Precision: 0.2429, Recall: 0.4499, F1: 0.3155
Epoch 28 - VAL: AUC: 0.6647, ACC: 0.6607, Precision: 0.1848, Recall: 0.5759, F1: 0.2798
Epoch 28 - TEST: AUC: 0.6622, ACC: 0.7681, Precision: 0.2319, Recall: 0.4241, F1: 0.2998
Epoch 29 - VAL: AUC: 0.6778, ACC: 0.7742, Precision: 0.2482, Recall: 0.4793, F1: 0.3271
Epoch 29 - TEST: AUC: 0.6885, ACC: 0.8082, Precision: 0.2928, Recall: 0.4507, F1: 0.3549
Epoch 30 - VAL: AUC: 0.6748, ACC: 0.7236, Precision: 0.2137, Recall: 0.5276, F1: 0.3042
Epoch 30 - TEST: AUC: 0.6801, ACC: 0.7918, Precision: 0.2710, Recall: 0.4605, F1: 0.3412
Epoch 31 - VAL: AUC: 0.6885, ACC: 0.8188, Precision: 0.2993, Recall: 0.4345, F1: 0.3544
Epoch 31 - TEST: AUC: 0.6896, ACC: 0.7570, Precision: 0.2468, Recall: 0.5243, F1: 0.3356
Epoch 32 - VAL: AUC: 0.6924, ACC: 0.7260, Precision: 0.2252, Recall: 0.5707, F1: 0.3229
Epoch 32 - TEST: AUC: 0.6914, ACC: 0.7840, Precision: 0.2677, Recall: 0.4871, F1: 0.3455
Epoch 33 - VAL: AUC: 0.6944, ACC: 0.7675, Precision: 0.2457, Recall: 0.4983, F1: 0.3292
Epoch 33 - TEST: AUC: 0.6956, ACC: 0.7944, Precision: 0.2770, Recall: 0.4697, F1: 0.3484
Epoch 34 - VAL: AUC: 0.6976, ACC: 0.7570, Precision: 0.2406, Recall: 0.5207, F1: 0.3292
Epoch 34 - TEST: AUC: 0.6951, ACC: 0.7705, Precision: 0.2586, Recall: 0.5144, F1: 0.3442
Epoch 35 - VAL: AUC: 0.6994, ACC: 0.7454, Precision: 0.2343, Recall: 0.5397, F1: 0.3267
Epoch 35 - TEST: AUC: 0.6952, ACC: 0.7462, Precision: 0.2403, Recall: 0.5402, F1: 0.3326
Epoch 36 - VAL: AUC: 0.6931, ACC: 0.7848, Precision: 0.2617, Recall: 0.4828, F1: 0.3394
Epoch 36 - TEST: AUC: 0.6982, ACC: 0.7685, Precision: 0.2570, Recall: 0.5167, F1: 0.3432
Epoch 37 - VAL: AUC: 0.7103, ACC: 0.7720, Precision: 0.2610, Recall: 0.5414, F1: 0.3522
Epoch 37 - TEST: AUC: 0.7035, ACC: 0.8144, Precision: 0.3082, Recall: 0.4704, F1: 0.3724
Epoch 38 - VAL: AUC: 0.7057, ACC: 0.8048, Precision: 0.2868, Recall: 0.4741, F1: 0.3574
Epoch 38 - TEST: AUC: 0.6977, ACC: 0.7651, Precision: 0.2547, Recall: 0.5228, F1: 0.3425
Epoch 39 - VAL: AUC: 0.7164, ACC: 0.7846, Precision: 0.2737, Recall: 0.5328, F1: 0.3616
Epoch 39 - TEST: AUC: 0.7103, ACC: 0.7483, Precision: 0.2461, Recall: 0.5577, F1: 0.3415
Epoch 40 - VAL: AUC: 0.7107, ACC: 0.7856, Precision: 0.2696, Recall: 0.5103, F1: 0.3528
Epoch 40 - TEST: AUC: 0.7091, ACC: 0.7450, Precision: 0.2458, Recall: 0.5698, F1: 0.3435
Epoch 41 - VAL: AUC: 0.7047, ACC: 0.7679, Precision: 0.2561, Recall: 0.5397, F1: 0.3474
Epoch 41 - TEST: AUC: 0.7081, ACC: 0.7863, Precision: 0.2789, Recall: 0.5205, F1: 0.3632
Epoch 42 - VAL: AUC: 0.7129, ACC: 0.7809, Precision: 0.2655, Recall: 0.5172, F1: 0.3509
Epoch 42 - TEST: AUC: 0.7082, ACC: 0.7584, Precision: 0.2498, Recall: 0.5311, F1: 0.3398
Epoch 43 - VAL: AUC: 0.7143, ACC: 0.7537, Precision: 0.2466, Recall: 0.5603, F1: 0.3425
Epoch 43 - TEST: AUC: 0.7174, ACC: 0.7579, Precision: 0.2545, Recall: 0.5539, F1: 0.3488
Epoch 44 - VAL: AUC: 0.7217, ACC: 0.7483, Precision: 0.2432, Recall: 0.5672, F1: 0.3404
Epoch 44 - TEST: AUC: 0.7088, ACC: 0.7923, Precision: 0.2786, Recall: 0.4871, F1: 0.3545
Epoch 45 - VAL: AUC: 0.7224, ACC: 0.7560, Precision: 0.2492, Recall: 0.5621, F1: 0.3453
Epoch 45 - TEST: AUC: 0.7184, ACC: 0.7246, Precision: 0.2361, Recall: 0.6047, F1: 0.3396
Epoch 46 - VAL: AUC: 0.7117, ACC: 0.7495, Precision: 0.2442, Recall: 0.5672, F1: 0.3415
Epoch 46 - TEST: AUC: 0.7124, ACC: 0.8146, Precision: 0.3092, Recall: 0.4727, F1: 0.3738
Epoch 47 - VAL: AUC: 0.7238, ACC: 0.7862, Precision: 0.2780, Recall: 0.5431, F1: 0.3678
Epoch 47 - TEST: AUC: 0.7221, ACC: 0.7778, Precision: 0.2728, Recall: 0.5395, F1: 0.3624
Epoch 48 - VAL: AUC: 0.7210, ACC: 0.8069, Precision: 0.2940, Recall: 0.4897, F1: 0.3674
Epoch 48 - TEST: AUC: 0.7231, ACC: 0.7961, Precision: 0.2886, Recall: 0.5061, F1: 0.3676
Epoch 49 - VAL: AUC: 0.7219, ACC: 0.7722, Precision: 0.2612, Recall: 0.5414, F1: 0.3524
Epoch 49 - TEST: AUC: 0.7083, ACC: 0.7636, Precision: 0.2585, Recall: 0.5455, F1: 0.3508
Epoch 50 - VAL: AUC: 0.7218, ACC: 0.7600, Precision: 0.2535, Recall: 0.5638, F1: 0.3497
Epoch 50 - TEST: AUC: 0.7229, ACC: 0.7303, Precision: 0.2389, Recall: 0.5964, F1: 0.3411
Epoch 51 - VAL: AUC: 0.7207, ACC: 0.7278, Precision: 0.2313, Recall: 0.5931, F1: 0.3328
Epoch 51 - TEST: AUC: 0.6998, ACC: 0.7784, Precision: 0.2637, Recall: 0.4985, F1: 0.3450
Epoch 52 - VAL: AUC: 0.7102, ACC: 0.7858, Precision: 0.2711, Recall: 0.5155, F1: 0.3553
Epoch 52 - TEST: AUC: 0.7156, ACC: 0.7938, Precision: 0.2843, Recall: 0.5015, F1: 0.3629
Epoch 53 - VAL: AUC: 0.7202, ACC: 0.7284, Precision: 0.2329, Recall: 0.5983, F1: 0.3353
Epoch 53 - TEST: AUC: 0.7202, ACC: 0.7417, Precision: 0.2465, Recall: 0.5865, F1: 0.3471
Epoch 54 - VAL: AUC: 0.7221, ACC: 0.7621, Precision: 0.2522, Recall: 0.5483, F1: 0.3455
Epoch 54 - TEST: AUC: 0.7266, ACC: 0.7468, Precision: 0.2473, Recall: 0.5690, F1: 0.3447
Epoch 55 - VAL: AUC: 0.7231, ACC: 0.7385, Precision: 0.2379, Recall: 0.5828, F1: 0.3378
Epoch 55 - TEST: AUC: 0.7188, ACC: 0.7671, Precision: 0.2612, Recall: 0.5410, F1: 0.3523
Epoch 56 - VAL: AUC: 0.7270, ACC: 0.7740, Precision: 0.2659, Recall: 0.5534, F1: 0.3593
Epoch 56 - TEST: AUC: 0.7281, ACC: 0.7553, Precision: 0.2569, Recall: 0.5759, F1: 0.3553
Epoch 57 - VAL: AUC: 0.7365, ACC: 0.7529, Precision: 0.2547, Recall: 0.6017, F1: 0.3579
Epoch 57 - TEST: AUC: 0.7289, ACC: 0.7524, Precision: 0.2557, Recall: 0.5835, F1: 0.3556
Epoch 58 - VAL: AUC: 0.7257, ACC: 0.7773, Precision: 0.2678, Recall: 0.5448, F1: 0.3591
Epoch 58 - TEST: AUC: 0.7282, ACC: 0.7368, Precision: 0.2448, Recall: 0.5986, F1: 0.3475
Epoch 59 - VAL: AUC: 0.7432, ACC: 0.7254, Precision: 0.2382, Recall: 0.6362, F1: 0.3466
Epoch 59 - TEST: AUC: 0.7312, ACC: 0.7604, Precision: 0.2590, Recall: 0.5622, F1: 0.3546
Epoch 60 - VAL: AUC: 0.7446, ACC: 0.7075, Precision: 0.2325, Recall: 0.6759, F1: 0.3460
Epoch 60 - TEST: AUC: 0.7273, ACC: 0.7404, Precision: 0.2440, Recall: 0.5804, F1: 0.3436
Epoch 61 - VAL: AUC: 0.7368, ACC: 0.7758, Precision: 0.2664, Recall: 0.5466, F1: 0.3582
Epoch 61 - TEST: AUC: 0.7324, ACC: 0.6941, Precision: 0.2238, Recall: 0.6533, F1: 0.3333
Epoch 62 - VAL: AUC: 0.7283, ACC: 0.7043, Precision: 0.2235, Recall: 0.6397, F1: 0.3313
Epoch 62 - TEST: AUC: 0.7120, ACC: 0.6947, Precision: 0.2178, Recall: 0.6206, F1: 0.3225
Epoch 63 - VAL: AUC: 0.7428, ACC: 0.7511, Precision: 0.2531, Recall: 0.6017, F1: 0.3563
Epoch 63 - TEST: AUC: 0.7352, ACC: 0.7198, Precision: 0.2368, Recall: 0.6267, F1: 0.3437
Traceback (most recent call last):
  File "run_W_PANCDR_5Critic_nested.py", line 86, in <module>
    auc_test_df = train_W_PANCDR_nested(n_outer_splits,data,best_params_file)
  File "/mnt/W-PANCDR/src/ModelTraining/W_PANCDR_5Critic.py", line 307, in train_W_PANCDR_nested
    auc_TEST, current_epoch = model.train(current_params, weight_path=f'../checkpoint/GDSC_kfold/model_best_outerfold_{outer_fold}_{i}.pt')
  File "/mnt/W-PANCDR/src/ModelTraining/W_PANCDR_5Critic.py", line 134, in train
    F_t_gexpr = EN_model(t_gexpr)    # real (TCGA)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1423, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/W-PANCDR/src/ModelTraining/model.py", line 196, in forward
    output = self.encoder(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1423, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1423, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1491, in __getattr__
    def __getattr__(self, name: str) -> Union[Tensor, 'Module']:
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/wandb/sdk/lib/service_connection.py", line 94, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/usr/local/lib/python3.8/dist-packages/wandb/sdk/lib/service_connection.py", line 226, in teardown
    self._router.join()
  File "/usr/local/lib/python3.8/dist-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/usr/lib/python3.8/threading.py", line 1011, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.8/threading.py", line 1027, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
